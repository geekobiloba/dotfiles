#
# Windows run_once_after (post-apply)
#

################################################################################
# BEGIN
################################################################################

Write-Host "Starting Windows run_once_after (post-apply)" `
  -ForegroundColor Green

################################################################################
# Nmap
################################################################################

# {{- if stat (joinPath "C:" "Program Files (x86)" "Nmap") }}
Invoke-Item "${env:ProgramFiles(x86)}\Nmap\nmap_performance.reg"

# Add Nmap to path
[Environment]::SetEnvironmentVariable(
  "Path" ,
  $env:Path + ";" + "${env:ProgramFiles(x86)}\Nmap" ,
  "User"
)

# Clean empty and duplicate fields
[Environment]::SetEnvironmentVariable(
  $env:Path     -split    ';'     |
  Select-String -NotMatch '^\s*$' |
  Select-Object -Unique
) -join ";"

# {{- end }}

################################################################################
# nvs
################################################################################

# {{- if not (stat (joinPath .chezmoi.homeDir "AppData" "Local" "nvs" "node")) }}
# Add Node.js LTS
nvs add lts
# {{- end }}

################################################################################
# END
################################################################################

Write-Host "Windows run_once_after (post-apply) is done" `
  -ForegroundColor Green

# vim: ft=ps1:
